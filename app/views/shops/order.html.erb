<%= render 'shops/shop_nav'%>
<h2>All Orders</h2>
<div class="shop-order-processing container-md">
      <% if @shop.order_details.any? %>
      <table class="All-orders table table-striped table-hover">
      <thead>
          <tr class="table-dark">
              <th scope="col">#</th>
              <th scope="col">Title</th>
              <th scope="col">Author</th>
              <th scope="col">Quantity</th>
              <th scope="col">Total Price</th>
              <th scope="col">Shipping Address</th>
              <th scope="col">Payment Method</th>
              <th scope="col">Created at</th>
              <th scope="col">Actions</th>
          </tr>
      </thead>
      <tbody>
          <% @orders.each.with_index(1) do |order| %>
              <%book = Book.find(order.Book_id)%>
              <%order_belongs = Order.find(order.Order_id)%>
              <tr>
                  <th scope="row"><%= order.id %></th>
                  <td><%= book.title%></td> 
                  <td><%= book.author%></td> 
                  <td><%= order.quantity %></td>
                  <td><%= number_to_currency order.total_price %></td>
                  <td><%= order_belongs.shipping_address %></td>
                  <td><%= order_belongs.payment_method %></td>
                  <td><%= order_belongs.created_at.strftime("%d-%m-%Y") %></td>
                  <td><%= link_to "Done", order_detail_path(order), class: 'btn btn-primary actions', method: :patch %></td>
                  <%# <td><%= link_to "Edit", edit_shop_book_path(@shop, book) <%= link_to "Delete", shop_book_path(@shop, book), method: :delete %>
              </tr>
          <% end %>
      </tbody>
      </table>

    <% if @orders.total_pages > 1 %>
      <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">

          <% if @orders.current_page == 1 %>
            <li class="page-item disabled">  
              <a class="page-link" href="#" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
              </a>
            </li>
          <% else %>
            <li class="page-item">  
              <a class="page-link" href="<%= url_for(page: @orders.current_page - 1)%>" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
              </a>
            </li>
          <% end %>
            
          <% (1..@orders.total_pages).each do |page| %>
            <% if page == @orders.current_page %>
              <li class="page-item active"><a class="page-link" href="#"><%=page%></a></li>
            <% else %>
              <li class="page-item"><a class="page-link" href="<%= url_for(page: page) %>"><%=page%></a></li>
            <% end %>
          <% end %>
        
          <% if @orders.current_page == @orders.total_pages %>
            <li class="page-item disabled">  
              <a class="page-link" href="#" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
          <% else %>
            <li class="page-item">  
              <a class="page-link" href="<%= url_for(page: @orders.current_page + 1)%>" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
          <% end %>
        </ul>
      </nav>
    <% end %>
  <% end %>
  </div>